<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Protobone.Model - protobone</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png" width="117" height="52">protobone: Protobone.Model</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.4</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Modules</h2>
                </div>
                <div class="bd">
                    <ul>
                    </ul>
                </div>
            </div>
            
            <div id="classes" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Classes</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="../classes/Protobone.Base.html">Protobone.Base</a></li>
                            <li><a href="../classes/Protobone.Collection.html">Protobone.Collection</a></li>
                            <li><a href="../classes/Protobone.Model.html">Protobone.Model</a></li>
                    </ul>
                </div>
            </div>
            
            <div id="methods-on-page" class="sidebox on-page">
                <div class="hd">
                    <h2 class="no-toc">Methods On Page</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="#methods_constructor">constructor</a></li>
                            <li><a href="#methods_destroy">destroy</a></li>
                            <li><a href="#methods_fetch">fetch</a></li>
                            <li><a href="#methods_fireEvent">fireEvent</a></li>
                            <li><a href="#methods_get">get</a></li>
                            <li><a href="#methods_getId">getId</a></li>
                            <li><a href="#methods_hasAttribute">hasAttribute</a></li>
                            <li><a href="#methods_off">off</a></li>
                            <li><a href="#methods_on">on</a></li>
                            <li><a href="#methods_parse">parse</a></li>
                            <li><a href="#methods_save">save</a></li>
                            <li><a href="#methods_set">set</a></li>
                            <li><a href="#methods_setId">setId</a></li>
                            <li><a href="#methods_sync">sync</a></li>
                            <li><a href="#methods_sync">sync</a></li>
                            <li><a href="#methods_url">url</a></li>
                    </ul>
                </div>
            </div>
            
            
            
            
            <div id="fileTree" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Files</h2>
                </div>
                <div class="bd">
                    <ul><li>src/<ul><li><a href="../files/src_Base.js.html">Base.js</a></li><li><a href="../files/src_Collection.js.html">Collection.js</a></li><li><a href="../files/src_Model.js.html">Model.js</a></li><li><a href="../files/src_statics.js.html">statics.js</a></li></ul></li></ul>
                </div>
            </div>
            
        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>Class Protobone.Model</h4>
    Extends: <a href="../classes/Protobone.Base.html" class="crosslink">Protobone.Base</a><br>
<span class="foundat">Class defined in: <a href="../files/src_statics.js.html#l1"><code>src&#x2F;statics.js:1</code></a></span>
<div class="intro"><p>PrototypeJS Model extension - Enables Prototype JS users to fetch / store
Models from / to a backend using AJAX / REST</p>
<p>Inspired by (but not copied) Backbone&#39;s Backbone.Model and Backbone.sync</p>
</div>

    <a name="methods_Protobone.Model"></a>
    <div class="method item">
         <strong class="name"><code>Protobone.Model</code></strong>( <code>  </code> ) 
        <br>
        <span class="foundat">
            
            <a href="../files/src_statics.js.html#l1"><code>src&#x2F;statics.js:1</code></a>
        </span><br>
        
    </div>

<div id="classdocs">
    <ul>
        <li><a href="#methods">Methods</a></li>
        <li><a href="#props">Properties</a></li>
    </ul>
    <div>
            <div id="methods">
<a name="methods_constructor"></a>
<div class="method item">
     <strong class="name"><code>constructor</code></strong>( <code>data </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l63"><code>src&#x2F;Model.js:63</code></a>
    </span><br>
    <p>Constructor. Sets the given data (key/value pairs)
as attributes on new model instances.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>data</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a>&gt;</strong>
        <p>Initial data (key/value pairs) to set on the new Model instance, e.g.: <code>{name: &#39;Alex&#39;,age: 26}</code></p>

        </li>
    </ul>
</div>
<a name="methods_destroy"></a>
<div class="method item">
     <strong class="name"><code>destroy</code></strong>( <code>options </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l234"><code>src&#x2F;Model.js:234</code></a>
    </span><br>
    <p>invokes a delete request to the server.  Only
allowed for existing (id &lt;&gt; null) models. options is passed
along to Prototype&#39;s Ajax.Request function.</p>
<p>After the deletion was successful, the model instance is updated with the
server data, even if the server removed the instance.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>options</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a>&gt;</strong>
        <p>Additional Ajax options to be sent to Ajax.Request.</p>

        </li>
    </ul>
</div>
<a name="methods_fetch"></a>
<div class="method item">
     <strong class="name"><code>fetch</code></strong>( <code>options </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l217"><code>src&#x2F;Model.js:217</code></a>
    </span><br>
    <p>Fetches this Model&#39;s representation from the server. Only
allowed for existing (id &lt;&gt; null) models. options is passed
along to Prototype&#39;s Ajax.Request function.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>options</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a>&gt;</strong>
        <p>Additional Ajax options to be sent to Ajax.Request.</p>

        </li>
    </ul>
</div>
<a name="methods_fireEvent"></a>
<div class="method item">
    <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a> <strong class="name"><code>fireEvent</code></strong>( <code>eventName </code> ) 
    <br>
    <span class="foundat">
         Defined in <a href="Protobone.Base.html#method_fireEvent">Protobone.Base</a>: 
        <a href="../files/src_Base.js.html#l60"><code>src&#x2F;Base.js:60</code></a>
    </span><br>
    <p>Fires an event, informing all listneners that are registered for
the given event name. The fireEvent function can be called with
any number of additional arguments, which are then passed to the event
handler function.</p>
<p>Returns true if NONE of the registered handlers return false: As soon as
one listener returns false, fireEvent will also return false.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>eventName</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a>&gt;</strong>
        <p>The event to fire, e.g. &#39;updated&#39;</p>

        </li>
    </ul>
    <br><div class="returns"><strong>Returns:</strong> &lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a>&gt; <p>true when non of the listeners returned false, false if they do so.</p>
</div>
</div>
<a name="methods_get"></a>
<div class="method item">
    Mixed <strong class="name"><code>get</code></strong>( <code>key </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l154"><code>src&#x2F;Model.js:154</code></a>
    </span><br>
    <p>Returns a specific attribute, or all if key is omitted</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>key</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a>&gt;</strong>
        <p>The name of the attribute to get. If omitted, an object
   containing all attributes (key/value) is returned.</p>

        </li>
    </ul>
    <br><div class="returns"><strong>Returns:</strong> &lt;Mixed&gt; <p>The value of the requested attribute, or an object with all attributes</p>
</div>
</div>
<a name="methods_getId"></a>
<div class="method item">
    Mixed <strong class="name"><code>getId</code></strong>( <code>  </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l81"><code>src&#x2F;Model.js:81</code></a>
    </span><br>
    <p>Returns the instance&#39;s ID of the model. Null means it is a new, not saved
instance.</p>

    <br><div class="returns"><strong>Returns:</strong> &lt;Mixed&gt; <p>The ID (int, string), if any</p>
</div>
</div>
<a name="methods_hasAttribute"></a>
<div class="method item">
    <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a> <strong class="name"><code>hasAttribute</code></strong>( <code>key </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l304"><code>src&#x2F;Model.js:304</code></a>
    </span><br>
    <p>Checks if the model has a certain attribute.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>key</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a>&gt;</strong>
        <p>The attribute name to check</p>

        </li>
    </ul>
    <br><div class="returns"><strong>Returns:</strong> &lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a>&gt; </div>
</div>
<a name="methods_off"></a>
<div class="method item">
     <strong class="name"><code>off</code></strong>( <code>eventName, callback, this </code> ) 
    <br>
    <span class="foundat">
         Defined in <a href="Protobone.Base.html#method_off">Protobone.Base</a>: 
        <a href="../files/src_Base.js.html#l34"><code>src&#x2F;Base.js:34</code></a>
    </span><br>
    <p>Removes a specific event handler for an event, or removes
all listerners from an event.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>eventName</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a>&gt;</strong>
        <p>E.g. &#39;updated&#39;</p>

        </li>
        <li>
            <code>callback</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function" class="crosslink external" target="_blank">Function</a>&gt;</strong>
        <p>The callback to remove. If omitted, all callbacks
  for a specific event are removed</p>

        </li>
        <li>
            <code>this</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a>&gt;</strong>
         
        </li>
    </ul>
</div>
<a name="methods_on"></a>
<div class="method item">
     <strong class="name"><code>on</code></strong>( <code>eventName, callback, this </code> ) 
    <br>
    <span class="foundat">
         Defined in <a href="Protobone.Base.html#method_on">Protobone.Base</a>: 
        <a href="../files/src_Base.js.html#l16"><code>src&#x2F;Base.js:16</code></a>
    </span><br>
    <p>Registers an event handler.
It does not check on duplicity, so you can add the same event
handler multiple times.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>eventName</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a>&gt;</strong>
        <p>The name of the event, e.g. &#39;updated&#39;</p>

        </li>
        <li>
            <code>callback</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function" class="crosslink external" target="_blank">Function</a>&gt;</strong>
        <p>The listener function, called with event-specific {parameters}</p>

        </li>
        <li>
            <code>this</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a>&gt;</strong>
         
        </li>
    </ul>
</div>
<a name="methods_parse"></a>
<div class="method item">
     <strong class="name"><code>parse</code></strong>( <code>  </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l286"><code>src&#x2F;Model.js:286</code></a>
    </span><br>
    <p>Called by save() and fetch() with the server&#39;s data response. Fills in the
server response to the model. In the default implementation, it just
takes the plain JSON object from the server (if any) and store the values on the model.
if <code>rootProperty</code>is set, the data entry point is set to the rootProperty data.</p>

</div>
<a name="methods_save"></a>
<div class="method item">
     <strong class="name"><code>save</code></strong>( <code>options </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l194"><code>src&#x2F;Model.js:194</code></a>
    </span><br>
    <p>Makes this model persistent by sending the data to a REST interface (by default).
Make sure to set the urlRool property on class definition.</p>
<p>options are all options that Prototype&#39;s Ajax.Request understands, so you
can e.g. deliver a onSuccess callback:</p>
<pre class="code prettyprint"><code class="lang-javascript">myModel.save({onSuccess: function(response,model){
    // do something after save here
}});
</code></pre>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>options</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a>&gt;</strong>
        <p>Additional Ajax options to be sent to Ajax.Request.</p>

        </li>
    </ul>
</div>
<a name="methods_set"></a>
<div class="method item">
    This <strong class="name"><code>set</code></strong>( <code>&#x2F;Object, value </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l106"><code>src&#x2F;Model.js:106</code></a>
    </span><br>
    <p>Sets Model attributes (key/values). Takes either a key and a value,
or a plain object containing key/value pairs.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>&#x2F;Object</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a>&gt;</strong>
        <p>keyOrObject A string representing the key (e.g. &#39;name&#39;)
   or an object with key/values (e.g. &#39;name&#39;:&#39;alex&#39;,&#39;age&#39;:&#39;too old&#39;)</p>

        </li>
        <li>
            <code>value</code> <strong>&lt;Mixed&gt;</strong>
        <p>The value to set if keyOrObject is a string. Ignored when keyOrObject is an object.</p>

        </li>
    </ul>
    <br><div class="returns"><strong>Returns:</strong> &lt;This&gt; <p>Supports fluent interface by returning itself</p>
</div>
</div>
<a name="methods_setId"></a>
<div class="method item">
    This <strong class="name"><code>setId</code></strong>( <code>id </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l92"><code>src&#x2F;Model.js:92</code></a>
    </span><br>
    <p>Sets the Model instance&#39;s ID. It also sets it as attribute
value so that it is sent to the server when synced.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>id</code> <strong>&lt;Mixed&gt;</strong>
        <p>The id to set (e.g. an integer, or even a string)</p>

        </li>
    </ul>
    <br><div class="returns"><strong>Returns:</strong> &lt;This&gt; <p>Supports fluent interface by returning itself</p>
</div>
</div>
<a name="methods_sync"></a>
<div class="method item">
     <strong class="name"><code>sync</code></strong>( <code>url, method, model, options </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_statics.js.html#l61"><code>src&#x2F;statics.js:61</code></a>
    </span><br>
    <p>This method is where the real server communication happens. It uses
Prototype&#39;s Ajax.Request to send / load data to/from a REST backend.
It is called in a static context (<code>Protobone.Model.sync</code>) from a Model&#39;s instance
and can be overridden if you have to implement your own storage backend (e.g. localstore)
or an incompatible API.</p>
<p>The default method uses the following HTTP methods</p>
<ul>
<li>method: create -&gt; <code>POST /collection</code></li>
<li>method: read   -&gt; <code>GET  /collection[/id]</code></li>
<li>method: update -&gt; <code>POST /collection/id</code> (Request Header: <code>X-HTTP-Method-Override: put</code>)</li>
<li>method: delete -&gt; <code>POST /collection/id</code> (Request Header: <code>X-HTTP-Method-Override: delete</code>)</li>
</ul>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>url</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a>&gt;</strong>
        <p>The URL for the request</p>

        </li>
        <li>
            <code>method</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a>&gt;</strong>
        <p>The HTTP method. Only supported at the moment: &#39;get&#39;, &#39;post&#39; (as of Prototype&#39;s limitation)</p>

        </li>
        <li>
            <code>model</code> <strong>&lt;<a href="../classes/Protobone.Model.html" class="crosslink">Protobone.Model</a>&gt;</strong>
        <p>A model instance to be sent / updated to /from the server</p>

        </li>
        <li>
            <code>options</code> <strong>&lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object" class="crosslink external" target="_blank">Object</a>&gt;</strong>
        <p>Additional Ajax.Request options</p>

        </li>
    </ul>
</div>
<a name="methods_sync"></a>
<div class="method item">
     <strong class="name"><code>sync</code></strong>( <code>  </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l275"><code>src&#x2F;Model.js:275</code></a>
    </span><br>
    <p>Just calls Protobone.Model.sync. If you want your own, Model-specific implementation,
override this function.</p>

</div>
<a name="methods_url"></a>
<div class="method item">
    <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a> <strong class="name"><code>url</code></strong>( <code>  </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/src_Model.js.html#l173"><code>src&#x2F;Model.js:173</code></a>
    </span><br>
    <p>Creates the REST url for the actual state of the Model. Override this
method if you want to implement your own URL scheme. Here is how it works
by default:</p>
<ul>
<li>non-persistent state (id = null): return &#39;<urlRoot>&#39;</li>
<li>persistent state (id &lt;&gt; null): return &#39;<urlRoot>/<id>&#39;</li>
</ul>

    <br><div class="returns"><strong>Returns:</strong> &lt;<a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a>&gt; <p>The URL for this Model instance, e.g. <code>/root/Entity/3</code></p>
</div>
</div>
            </div>
            <div id="props">
                <a name="props_emulateHTTP"></a>
                <div class="props item">
                    <code>emulateHTTP</code> &lt;<strong><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a></strong>&gt;<br>
                    <span class="foundat"><a href="../files/src_statics.js.html#l39"><code>src&#x2F;statics.js:39</code></a></span>
                    <p>If set to true, only use GET (read) and POST (create,update,delete) HTTP
                Methods, and set the X-HTTP-Method-Override request header with the
                true method.</p>
                <p>NOTE: TODO: At the moment, only legacy methods (GET/POST) are supported (emulateHTTP: true),
                because the Prototype JS library does NOT support other requests than POST/GET.
                So set emulateHTTP to false does not change a thing, unfortunately...</p>
                
                </div>
                <a name="props_emulateJSON"></a>
                <div class="props item">
                    <code>emulateJSON</code> &lt;<strong><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Boolean" class="crosslink external" target="_blank">Boolean</a></strong>&gt;<br>
                    <span class="foundat"><a href="../files/src_statics.js.html#l53"><code>src&#x2F;statics.js:53</code></a></span>
                    <p>TODO: Implement emulateJSON to use a post body instead of RAW json</p>
                
                </div>
                <a name="props_id"></a>
                <div class="props item">
                    <code>id</code> &lt;<strong>Unknown</strong>&gt;<br>
                    <span class="foundat"><a href="../files/src_Model.js.html#l36"><code>src&#x2F;Model.js:36</code></a></span>
                    <p>Defines the name of the ID attribute. Defaults to <code>id</code>.</p>
                
                </div>
                <a name="props_rootProperty"></a>
                <div class="props item">
                    <code>rootProperty</code> &lt;<strong>Unknown</strong>&gt;<br>
                    <span class="foundat"><a href="../files/src_Model.js.html#l53"><code>src&#x2F;Model.js:53</code></a></span>
                    <p>Used by the parse() function, it defines the root property
                in the server&#39;s json response which contains the
                payload data for the model. Defaults to null (delivered json
                directly contains model attributes)</p>
                
                </div>
                <a name="props_urlRoot"></a>
                <div class="props item">
                    <code>urlRoot</code> &lt;<strong><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String" class="crosslink external" target="_blank">String</a></strong>&gt;<br>
                    <span class="foundat"><a href="../files/src_Model.js.html#l43"><code>src&#x2F;Model.js:43</code></a></span>
                    <p>The URL root for this Model. Must be set in child classes,
                e.g. to &#39;/entities/Person&#39;.
                Used by the url() function to build the persistence URL.</p>
                
                </div>
            </div>
    </div>
</div>
</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
